(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(238)}])},238:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return y}});var n=a(5893),s=a(7294),r=a(381),l=a.n(r),o=a(44);let i=[{name:"Domain",selector:e=>e.domain,sortable:!0},{name:"Traffic Share",selector:e=>e.traffic_share,sortable:!0,cell:e=>(100*e.traffic_share).toFixed(2)+"%"},{name:"Position",selector:e=>e.position,sortable:!0},{name:"Destination URL",selector:e=>e.destination_url,sortable:!0,cell:e=>(0,n.jsx)("a",{href:e.destination_url,children:e.destination_url})},{name:"Website Categories",selector:e=>e.website_categories,sortable:!0}],c=e=>{let{data:t}=e;return(0,n.jsx)(o.ZP,{id:"my-table",title:"",columns:i,data:t,pagination:!0,highlightOnHover:!0})},u=e=>{let{id:t,min:a,max:r,value:l,onChange:o}=e;return(0,s.useEffect)(()=>{let e=document.getElementById(t);a&&e.setAttribute("min",a),r&&e.setAttribute("max",r)},[t,a,r]),(0,n.jsx)("input",{type:"month",id:t,value:l||"",onChange:o})};var d=a(7857),h=a(7785),m=a(7421);let f=e=>{let{volume:t}=e,a=(0,m.q_)({opacity:1,from:{opacity:0},delay:500});return(0,n.jsx)(m.q.div,{style:a,children:(0,n.jsx)(h.Z,{variant:"h4",component:"span",color:"primary",children:(0,n.jsx)(d.ZP,{start:0,end:t,duration:2.5,separator:","})})})};var x=a(4105),b=a(8102);let j=e=>{if(!e||!e.length){alert("錯誤！沒有資料可以匯出！");return}let t=x.P6.book_new(),a=x.P6.json_to_sheet(e);x.P6.book_append_sheet(t,a,"Sheet1");let n=x.cW(t,{bookType:"xlsx",type:"array"}),s=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});(0,b.saveAs)(s,"data.xlsx")},p=async(e,t,a,n)=>{let s="https://api.similarweb.com/v4/keywords/keyword/analysis/organic-competitors?api_key=".concat(e,"&keyword=").concat(t,"&start_date=").concat(a,"&end_date=").concat(n,"&country=tw&metrics=traffic,organic-vs-paid,volume,cpc&format=json&limit=30&sort=traffic_share");try{let e=await fetch(s),t=await e.json();return{data:t.traffic_breakdown,volume:t.search_volume.volume}}catch(e){console.error(e)}};var _=a(3253),v=a.n(_);function y(){let[e,t]=(0,s.useState)([]),[a,r]=(0,s.useState)(0),[o,i]=(0,s.useState)(null),[d,h]=(0,s.useState)(null),[m,x]=(0,s.useState)(""),[b,_]=(0,s.useState)(""),[y,w]=(0,s.useState)(""),[k,g]=(0,s.useState)(!1),[S,C]=(0,s.useState)("");(0,s.useEffect)(()=>{let e=l()(),t=e.clone().subtract(13,"months").format("YYYY-MM"),a=e.clone().subtract(1,"months").format("YYYY-MM");x(t),_(a),i(null),h(null)},[]);let E=async()=>{if(""===y){C("錯誤！請輸入查詢關鍵字！"),g(!0);return}if(!o||!d){C("錯誤！請輸入開始或結束的月份"),g(!0);return}let e="是否搜尋 ".concat(y," 在 ").concat(o," 至 ").concat(d," 的資料？");C(e),g(!0)},N=async()=>{if(g(!1),S.startsWith("是否搜尋")){let e=await p("81aa3fc0ace24fdcbf5ebcf73f79a8ff",y,o,d);e&&(t(e.data),r(e.volume))}},P=()=>{g(!1)},Y=()=>{j(e)};return(0,n.jsxs)("div",{children:[(0,n.jsxs)("h1",{children:["Similarweb",(0,n.jsx)("br",{}),"關鍵字各網站流量查詢"]}),(0,n.jsxs)("p",{className:"comment",children:["#選擇年、月。",(0,n.jsx)("br",{}),"#可選區間為上個月至12個月之前。",(0,n.jsx)("br",{}),"#數量上限30，按照Traffic Share排序。"]}),(0,n.jsx)("label",{children:"輸入關鍵字："}),(0,n.jsx)("input",{id:"query",value:y,onChange:e=>w(e.target.value)}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)("label",{htmlFor:"start-date",children:"開始日期："}),(0,n.jsx)(u,{id:"start-date",min:m,max:b,value:o,onChange:e=>i(e.target.value)}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)("label",{htmlFor:"end-date",children:"結束日期："}),(0,n.jsx)(u,{id:"end-date",min:m,max:b,value:d,onChange:e=>h(e.target.value)}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)("button",{className:"search-btn",onClick:E,children:"查詢"}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)("label",{children:"Search Volume："}),(0,n.jsx)(f,{volume:a}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(c,{data:e}),(0,n.jsx)("button",{className:"download-btn",onClick:Y,children:"下載Excel"}),(0,n.jsxs)(v(),{isOpen:k,onRequestClose:P,contentLabel:"Alert Modal",className:"modal",children:[(0,n.jsx)("div",{children:S}),S.startsWith("是否搜尋")&&(0,n.jsxs)("div",{children:[(0,n.jsx)("button",{onClick:N,children:"確認"}),(0,n.jsx)("button",{onClick:P,children:"取消"})]}),!S.startsWith("是否搜尋")&&(0,n.jsx)("button",{onClick:P,children:"確認"})]})]})}v().setAppElement("#__next")},67:function(){},2061:function(){}},function(e){e.O(0,[251,885,714,774,888,179],function(){return e(e.s=5557)}),_N_E=e.O()}]);